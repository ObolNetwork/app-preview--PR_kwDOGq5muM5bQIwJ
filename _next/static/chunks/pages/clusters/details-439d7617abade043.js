(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{50068:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clusters/details",function(){return t(92211)}])},92211:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var i=t(85893),n=t(39618),r=t(11163),l=t(2504),a=t(21237),d=t(30120),o=t(63029),c=t(48926),u=t(98376),x=t(9324),h=t(71866);let p=[{accessorKey:"address",header:"Address"},{accessorKey:"status",header:"Status",sortable:!0},{accessorKey:"withdrawalAddress",header:"Withdrawal Address"},{accessorKey:"feeRecipient",header:"Fee Recipient"}],j=e=>{let{validators:s,currentAccount:t}=e,r=(0,o.Z)(s.flatMap(e=>[e.withdrawalAddress,e.feeRecipient])),l=e=>{let{address:s,index:t}=e;return(0,i.jsxs)(n.xv,{size:"4",color:"obolGreen",css:{display:"flex",alignItems:"center",justifyContent:"start",gap:"xxxs"},children:[(0,i.jsxs)(n.kC,{direction:"column",css:{mr:"$xxs",fontWeight:"$bold"},children:[r[t]&&(0,i.jsxs)(i.Fragment,{children:[r[t],(0,i.jsx)("br",{})]}),(0,i.jsx)(n.dh,{css:{fontWeight:"bold",color:"$obolGreen",width:"120px !important"},value:(0,a.zN)(s,[0,6],5),readOnly:!0})]}),(0,i.jsx)(c.Z,{address:s})]})},d=e=>{let{address:s,index:t}=e;return r[t]?(0,i.jsxs)(i.Fragment,{children:[r[t],(0,i.jsx)("br",{}),(0,i.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)(n.dh,{value:s,readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,i.jsx)(c.Z,{address:s})]})]}):(0,i.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"start"},children:[(0,i.jsx)(n.dh,{value:(0,a.zN)(s,[0,6],5),readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,i.jsx)(c.Z,{address:s})]})};return(0,i.jsx)(h.g_,{css:{".table-container":{"@sm":{width:"900px"}}},children:(0,i.jsx)(n.Nk,{tabs:[{title:"Validators",tableProps:{columns:p,rows:s.map((e,s)=>({address:(0,i.jsxs)(n.xu,{css:{display:"flex",alignItems:"center",justifyContent:"start"},children:[(0,i.jsx)(n.dh,{value:(0,a.zN)(e.address,[0,6],5),readOnly:!0,css:{mr:"$xxs",color:"$obolGreen",width:"120px !important"}}),(0,i.jsx)(u.j,{link:"".concat(x.q2,"/validator/").concat(e.address)})]}),status:e.status||"Pending",withdrawalAddress:(0,a.qF)(t,e.withdrawalAddress)?(0,i.jsx)(l,{address:e.withdrawalAddress,index:s}):(0,i.jsx)(d,{address:e.withdrawalAddress,index:s}),feeRecipient:(0,a.qF)(t,e.feeRecipient)?(0,i.jsx)(l,{address:e.feeRecipient,index:s+1}):(0,i.jsx)(d,{address:e.feeRecipient,index:s+1})}))}}]})})},g=(0,n.zo)(n.kC,{flexDirection:"column",width:"auto",gap:"$2xl",px:"10%",py:"$5xl","@sm":{px:"10%",pb:"$5xl",pt:"$xl"}});t(67294);var v=t(19485);let f=e=>{let{heading:s,linkTitle:t,link:r}=e;return(0,i.jsxs)(n.mh,{children:[(0,i.jsx)(n.xu,{children:(0,i.jsx)(n.nQ,{})}),(0,i.jsxs)(n.xu,{css:{display:"flex",fd:"column",gap:"$sm"},children:[(0,i.jsx)(n.xu,{css:{display:"flex",fd:"column",gap:"$xs"},children:(0,i.jsx)(n.xv,{variant:"body",css:{color:"white"},children:s})}),r&&(0,i.jsxs)(n.rU,{css:{fontSize:"$4",fontWeight:"$normal"},target:"_blank",href:r,children:[t,(0,i.jsx)(n._j,{size:"sm"})]})]})]})},m=e=>{let{splitBalance:s,distribute:t,feeRecipientAddress:r,splitMetadata:a,handleOnDistributeETH:d}=e,{account:o}=(0,l.kR)(),c=(null==t?void 0:t.loading)?{variant:"tx"}:{},u=(null==t?void 0:t.loading)?{variant:"tx"}:{};return(0,i.jsxs)(n.kC,{css:{gap:"$lg","@sm":{flexDirection:"column",gap:"$md",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 2"}},children:[(0,i.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 1"},children:[(0,i.jsx)(n.kC,{css:{justifyContent:"space-between",alignItems:"center"},children:(0,i.jsx)(n.xv,{variant:"h4",children:"Exit Cluster"})}),(null==t?void 0:t.completed)?(0,i.jsx)(f,{heading:"ETH successfully distributed",linkTitle:"View on Etherscan",link:"https://".concat(x.pn,".etherscan.io/tx/").concat(null==t?void 0:t.txHash)}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.xv,{variant:"body",children:"Exit all validators in this cluster."}),(0,i.jsx)(n.xv,{variant:"body",children:"This cluster will no longer earn rewards."}),(0,i.jsx)(n.xv,{variant:"body",children:"Upon exiting the cluster you will be able to withdraw the original principle & claim all rewards."}),(0,i.jsx)(h.fl,{...c,color:"primary",type:"button",css:{width:"auto"},disabled:!(0,v.isAddress)(r)||"0"===s||!(null==a?void 0:a.recipients.some(e=>"0x0000000"===e.address.toLowerCase())),onClick:()=>d(),children:(null==t?void 0:t.loading)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.yC,{}),"Transaction in progress"]}):(0,i.jsx)(i.Fragment,{children:"Exit Cluster"})})]})]}),(0,i.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start",justifyContent:"flex-start",gridColumn:"span 1"},children:[(0,i.jsx)(n.kC,{css:{justifyContent:"space-between",alignItems:"center"},children:(0,i.jsx)(n.xv,{variant:"h4",children:"Claim ETH"})}),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(h.fl,{...u,color:"primary",type:"button",css:{width:"auto"},disabled:!(0,v.isAddress)(o)||!(null==a?void 0:a.recipients.some(e=>e.address.toLowerCase()===(null==o?void 0:o.toLowerCase()))),onClick:()=>null,fullWidth:!0,children:"Claim ETH"})})]})]})},w=e=>{let{clusterDefinition:s,validators:t,currentAccount:r,clusterStatus:l}=e;return(0,i.jsxs)(g,{children:[(0,i.jsxs)(n.kC,{direction:"column",css:{gap:"$xxs"},children:[(0,i.jsx)(n.xv,{variant:"h3",children:null==s?void 0:s.name}),(0,i.jsx)(n.xv,{variant:"metadata",color:"body",children:"Created ".concat(d.ou.fromISO(null==s?void 0:s.timestamp).toRelativeCalendar()," on ").concat(d.ou.fromISO(null==s?void 0:s.timestamp).toFormat("yyyy LLL dd"))})]}),(0,i.jsxs)(n.kC,{css:{gap:"$lg","@sm":{flexDirection:"column"}},children:[l?(0,i.jsx)(n.gK,{heading:"Cluster Status",status:l,tooltipContent:"The cluster aggregate status"}):(0,i.jsx)(n.gK,{heading:"Cluster Status",content:"Loading...",tooltipContent:"The cluster aggregate status"}),(0,i.jsx)(n.gK,{heading:"Operators",content:s.operators.length||"0",tooltipContent:"The number of cluster operators"}),(0,i.jsx)(n.gK,{heading:"Validators",content:(null==t?void 0:t.length)||"0",tooltipContent:"The number of cluster validators"})]}),(0,i.jsx)(h.Dq,{operators:s.operators,currentAccount:r,creatorAddress:s.creator.address}),t&&(null==t?void 0:t.length)>0?(0,i.jsx)(j,{validators:t.map((e,s)=>({id:s.toString(),...e}))}):(0,i.jsxs)(n.W2,{css:{gap:"$lg",alignItems:"flex-start"},children:[(0,i.jsx)(n.sQ,{heading:"Distributed Key Generation is incomplete"}),(0,i.jsx)(n.zx,{as:"a",href:"/dv?configHash=".concat(s.config_hash),target:"_blank",children:"Complete DKG"})]}),(null==t?void 0:t.length)>0&&(0,i.jsx)(m,{feeRecipientAddress:s.fee_recipient_address,handleOnDistributeETH:()=>null,splitBalance:"-",distribute:{completed:!1,loading:!1},splitMetadata:{recipients:[{address:"0x12312423423423"}]}})]})},b=e=>{let{children:s}=e;return(0,i.jsxs)(n.W2,{css:{borderRadius:0,marginTop:"$7xl"},children:[(0,i.jsx)(n.xv,{variant:"h4",children:"Error \uD83D\uDE25"}),(0,i.jsx)(n.xv,{variant:"body",children:s})]})},y=()=>{var e,s,t,d;let o=(0,r.useRouter)(),{account:c}=(0,l.kR)(),u=o.query.lockHash,{data:x,isLoading:h,error:p}=(0,l.sh)(u?"/lock/".concat(u):null);if(u&&!x&&!h)return(0,i.jsx)(b,{children:(null==p?void 0:null===(e=p.response)||void 0===e?void 0:null===(s=e.data)||void 0===s?void 0:s.message)||"Error: No details information provided, please double check the\n            link you followed or return to the home page."});if(p&&!x)return(0,i.jsx)(b,{children:null==p?void 0:null===(t=p.response)||void 0===t?void 0:null===(d=t.data)||void 0===d?void 0:d.message});if(!x||h)return(0,i.jsxs)(g,{children:[(0,i.jsx)(n.xv,{variant:"subline",children:"Loading cluster data..."}),";"]});let j=null==x?void 0:x.distributed_validators.map((e,s)=>({status:e.isLoadingValidatorStatus?(0,i.jsx)(n.xv,{children:"Loading ..."}):(0,i.jsx)(n.HV,{status:e.status,textVariant:"metricStatusCell"}),address:e.distributed_public_key,withdrawalAddress:(null==x?void 0:x.cluster_definition.validators)?null==x?void 0:x.cluster_definition.validators[s].withdrawal_address:null==x?void 0:x.cluster_definition.withdrawal_address,feeRecipient:(null==x?void 0:x.cluster_definition.validators)?null==x?void 0:x.cluster_definition.validators[s].fee_recipient_address:null==x?void 0:x.cluster_definition.fee_recipient_address}));return(0,i.jsx)(w,{clusterDefinition:x.cluster_definition,validators:j,currentAccount:c,clusterStatus:x.distributed_validators.some(e=>e.isLoadingValidatorStatus)?null:(0,a.Uq)(x)})};var C=y}},function(e){e.O(0,[120,774,888,179],function(){return e(e.s=50068)}),_N_E=e.O()}]);